# Llama 3.1 + MCP エージェント テストシナリオ集（Streamlit TODOアプリ向け）

対象アプリ（例）: `http://localhost:8501` で動かしている簡易 TODO アプリ  
（タスク追加フォーム + タスク一覧 + 優先度フィルタ + 未完了数表示）

---

## シナリオ1: 基本的なフォーム入力と一覧確認

### テスト観点

- 指定した URL にアクセスできるか
- 入力フォームのラベル（タスク名 / 優先度 / 追加ボタン）を正しく理解し、操作できるか
- 追加後にタスク一覧を正しく読み取れるか

### プロンプト（複数行）

> ローカルで起動済みの http://localhost:8501 を開いて、タスクを 3 件追加してください。  
> 1. タスク名: `牛乳を買う`, 優先度: `高`  
> 2. タスク名: `資料を読む`, 優先度: `中`  
> 3. タスク名: `ジョギング`, 優先度: `低`  
> 追加が終わったら、画面上に表示されているタスク一覧を読み取り、  
> 「タスク名」と「優先度」を表形式で教えてください。

### プロンプト（1行）

> ローカルで起動済みの http://localhost:8501 を開き、タスク名`牛乳を買う`優先度`高`・タスク名`資料を読む`優先度`中`・タスク名`ジョギング`優先度`低`の3件を追加し、その後画面のタスク一覧から「タスク名」と「優先度」を読み取って表形式で答えてください。操作中にブラウザのリロード・クローズはしないでください。

### 期待結果

- `http://localhost:8501` にナビゲートしている
- 3 つのタスクが追加されている  
  （アプリの UI 上でも 3 行ぶんのタスクが表示される）
- エージェントの回答例（内容レベル）:

  | タスク名     | 優先度 |
  | ------------ | ------ |
  | 牛乳を買う   | 高     |
  | 資料を読む   | 中     |
  | ジョギング   | 低     |

  のように、**UI と完全に一致する表**が返ってくること。

---

## シナリオ2: フィルタ機能の理解と利用

### テスト観点

- セレクトボックスを操作してフィルタ条件を変更できるか
- フィルタ後の一覧が「元の一覧の部分集合」であることを理解できているか
- フィルタ結果から情報を抽出できるか

### プロンプト（複数行）

> ローカルで起動済みの http://localhost:8501 を開いてください。  
> すでにいくつかタスクが登録されている前提で、  
> 画面の「表示する優先度」を `高` に変更してください。  
> その状態で画面に表示されているタスク一覧を読み取り、  
> 「タスク名」と「優先度」を表形式で教えてください。  
> なお、出力には `高` 以外の優先度のタスクを含めないでください。

### プロンプト（1行）

> ローカルで起動済みの http://localhost:8501 を開き、「表示する優先度」を`高`に変更した状態で画面のタスク一覧を読み取り、優先度`高`のタスクだけを対象に「タスク名」と「優先度」を表形式で答えてください（`中`や`低`は含めないでください）。

### 期待結果

- 「表示する優先度」セレクトボックスが `高` に変更される
- 表示されるタスク一覧には優先度が `高` のタスクのみが並ぶ
- エージェントの回答表に、`中` / `低` のタスクが混ざっていない
- 元の状態と見比べたとき、
  - フィルタ前: 複数の優先度が混在
  - フィルタ後: `高` のみ
  になっていること

---

## シナリオ3: 条件に合うタスクの更新（完了フラグの操作）

### テスト観点

- テキスト（タスク名）に基づいて正しい行を特定できるか
- 各行に対応するチェックボックスを操作して状態を更新できるか
- 更新後の状態（未完了タスク数）を UI から読み取れるか

### プロンプト（複数行）

> ローカルで起動済みの http://localhost:8501 を開いてください。  
> すでに複数のタスクが登録されているとします。  
> このうち、タスク名に `資料` という文字列を含むタスクを探し、  
> そのタスクの「完了」チェックボックスをオンにしてください。  
> その後、画面下部に表示されている「未完了タスク数」の値を読み取り、  
> その数値だけを答えてください。

### プロンプト（1行）

> ローカルで起動済みの http://localhost:8501 を開き、登録済みのタスクの中からタスク名に`資料`を含むタスクを探してその「完了」チェックボックスをオンにし、その後画面下部の「未完了タスク数」の値を読み取ってその数値だけを答えてください。

### 期待結果

- `資料` を含むタスク（例: `資料を読む`）の行を正しく見つけている
- 該当行のチェックボックスだけがオンになる（他のタスクは変えない）
- 画面下の `未完了タスク数: X` の表示を **変更後の値で** 読み取っている
- エージェントの回答は、例えば `未完了タスク数は 2 です。` のように  
  実際の UI の表示と一致している

---

## シナリオ5: 複合操作（追加 → 完了 → 集計）

### テスト観点

- マルチステップな操作（追加 → 更新 → 集計）を一連のタスクとして遂行できるか
- 一度行った操作の結果を、次のステップの前提として正しく扱えているか
- 最終的な集計値を UI から正しく読み取れるか

### プロンプト（複数行）

> ローカルで起動済みの http://localhost:8501 を開いてください。  
> まず、次の 3 つのタスクを追加してください。  
> 1. タスク名: `メール返信`, 優先度: `高`  
> 2. タスク名: `レポート作成`, 優先度: `高`  
> 3. タスク名: `散歩`, 優先度: `低`  
> 
> その後、タスク名に `メール` を含むタスクを完了にし、  
> 「表示する優先度」を `高` に変更してください。  
> 最後に、画面に表示されている「未完了タスク数」の値と、  
> 高優先度タスクの一覧（タスク名と完了/未完了）を表形式で教えてください。

### プロンプト（1行）

> ローカルで起動済みの http://localhost:8501 を開き、タスク名`メール返信`優先度`高`・`レポート作成`優先度`高`・`散歩`優先度`低`の3件を追加した後、タスク名に`メール`を含むタスクを完了にして「表示する優先度」を`高`に変更し、その状態で画面の「未完了タスク数」の値と高優先度タスクの「タスク名」と完了/未完了ステータスを表形式で答えてください。

### 期待結果

1. 3 つのタスクが正しく追加される  
2. `メール返信` のみが「完了」状態になる  
3. フィルタ `高` により `メール返信` と `レポート作成` だけが表示される  
4. 未完了タスク数は  
   - `レポート作成`（高・未完了）  
   - `散歩`（低・未完了）  
   など、アプリのロジック通りの値になっている
5. エージェントの回答例（内容レベル）:

   - 未完了タスク数: `2`
   - 高優先度タスク一覧:

     | タスク名       | 完了ステータス |
     | -------------- | -------------- |
     | メール返信     | 完了           |
     | レポート作成   | 未完了         |

   のように、実際の画面と整合している。

---

## シナリオ6: 無効な操作への対処（安全な失敗）

### テスト観点

- 存在しないタスクを指定されたときに、  
  無理に操作しようとせず「見つからない」と報告できるか
- ページ構造と矛盾する指示に対して、暴走せずに安全に失敗できるか

### プロンプト（複数行）

> ローカルで起動済みの http://localhost:8501 を開いてください。  
> 現在登録されているタスクの中から、  
> タスク名が `存在しないタスクXYZ` というタスクを探し、  
> 見つかったら完了にしてください。  
> 見つからなかった場合は、無理に操作せず  
> 「そのようなタスクは見つからなかった」とだけ答えてください。

### プロンプト（1行）

> ローカルで起動済みの http://localhost:8501 を開き、登録されているタスクの中からタスク名が`存在しないタスクXYZ`であるタスクを探して見つかったら完了にし、見つからなかった場合は他のタスクを変更せず「そのようなタスクは見つからなかった」とだけ答えてください。

### 期待結果

- 実際には `存在しないタスクXYZ` というタスクは一覧に存在しない
- エージェントは
  - それを正しく検出し
  - 他のタスクのチェックボックスを誤って操作しない
- 回答は「該当するタスクが見つからなかった」という趣旨になっている
